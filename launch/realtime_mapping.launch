<launch>
    <arg name="backup_in_ram" default="true"/>

    <node pkg="norlab_icp_mapper_ros" type="mapper_node" name="mapper_node" output="screen" respawn="true">
        <remap from="points_in" to="/points_filtered"/>
        <param name="robot_frame" value="base_link"/>
        <param name="odom_frame" value="odom"/>
        <param name="icp_config" value="$(find ctu_mapping)/params/realtime_icp_config.yaml"/>
        <param name="input_filters_config" value="$(find ctu_mapping)/params/realtime_input_filters.yaml"/>
        <param name="map_post_filters_config" value="$(find ctu_mapping)/params/realtime_post_filters.yaml"/>
        <param name="map_update_condition" value="overlap"/>
        <param name="map_update_overlap" value="0.95"/>
        <param name="sensor_max_range" value="50"/>
        <param name="min_dist_new_point" value="0.11"/>
        <param name="compute_prob_dynamic" value="true"/>
        <param name="map_tf_publish_rate" value="100"/>
	<param name="prior_dynamic" value="0.5" />
        <param name="threshold_dynamic" value="0.75" />
        <param name="beam_half_angle" value="0.003054326" /> <!-- 0.01 -->
        <param name="epsilon_a" value="0.01" />
        <param name="epsilon_d" value="0.01" />
        <param name="alpha" value="0.8" />
        <param name="beta" value="0.99" />
	<param name="is_online" value="true" />
	<param name="is_3D" value="true" />
	<param name="is_mapping" value="true" />
        <param name="save_map_cells_on_hard_drive" value="false"/>
        <param name="publish_tfs_between_registrations" value="false"/>
        <param name="backup_in_ram" value="$(arg backup_in_ram)"/>
    </node>

    <group if="$(arg backup_in_ram)">
        <node pkg="norlab_icp_mapper_backup" type="norlab_icp_mapper_backup_node" name="norlab_icp_mapper_backup_node" output="screen"/>
    </group>
</launch>
